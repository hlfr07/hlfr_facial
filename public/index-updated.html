<!-- ARCHIVO TEMPORAL - Copiar contenido completo al index.html original -->
<!-- Solo incluyo las funciones que deben agregarse/modificarse -->

<script>
// AGREGAR esta funci√≥n despu√©s de resetPipeline('verify'); y ANTES de registerFace()

function renderBackendProcessing(processing, prefix) {
  const refs = pipelineRefs[prefix];
  if (!refs || !processing) return;

  console.log(`üé® Rendering REAL backend processing for ${prefix}:`, processing);

  // Render cropped image from backend (REAL 112x112 crop)
  if (processing.croppedImageBase64) {
    const img = new Image();
    img.onload = () => {
      const ctx = refs.crop.getContext('2d');
      ctx.clearRect(0, 0, refs.crop.width, refs.crop.height);
      ctx.drawImage(img, 0, 0, refs.crop.width, refs.crop.height);
      console.log('‚úÖ REAL Cropped image rendered from backend');
    };
    img.src = 'data:image/png;base64,' + processing.croppedImageBase64;
  }

  // Render embedding bars (REAL count from ArcFace)
  if (processing.embeddingSize) {
    renderEmbeddingBars(refs.bars, processing.embeddingSize);
    console.log(`‚úÖ REAL Embedding: ${processing.embeddingSize} dimensions`);
  }

  // Log detection box from SCRFD
  if (processing.detectionBox) {
    console.log('üì¶ REAL Detection box from SCRFD:', processing.detectionBox);
  }

  // Display ALL backend logs
  if (processing.logs && processing.logs.length > 0) {
    console.group(`üìã BACKEND LOGS (${prefix})`);
    processing.logs.forEach(log => console.log(log));
    console.groupEnd();
  }
}

// MODIFICAR registerFace() - en el bloque "if (result.success)"
// AGREGAR despu√©s de la l√≠nea "const result = await response.json();"
/*
if (result.success) {
  // ‚úÖ NUEVO: Render REAL backend processing
  if (result.processing) {
    renderBackendProcessing(result.processing, 'register');
  }
  showMessage(registerMessage, result.message, 'success');
  // ... resto del c√≥digo
} else {
  showMessage(registerMessage, result.message, 'error');
  // ‚úÖ NUEVO: Log errors from backend
  if (result.logs) {
    console.error('‚ùå Backend Error Logs:', result.logs);
  }
}
*/

// MODIFICAR verifyFace() - en los bloques "if (result.verified)" y "else"
// AGREGAR despu√©s de obtener el result:
/*
if (result.verified) {
  // ‚úÖ NUEVO: Render REAL backend processing
  if (result.processing) {
    renderBackendProcessing(result.processing, 'verify');
  }
  resultBox.className = 'result-box active success';
  // ... resto del c√≥digo
} else {
  // ‚úÖ NUEVO: Render REAL backend processing even on failure
  if (result.processing) {
    renderBackendProcessing(result.processing, 'verify');
  }
  resultBox.className = 'result-box active error';
  // ... resto del c√≥digo
}
*/
</script>
